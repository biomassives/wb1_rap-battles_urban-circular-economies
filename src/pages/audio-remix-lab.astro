---
/**
 * audio-remix-lab.astro
 * Audio Upload & Remix Laboratory
 *
 * Features:
 * - Upload audio files (WAV, MP3, M4A, OGG)
 * - Upload images for vector-to-sound conversion
 * - Mix uploaded audio with generated sounds
 * - Apply effects and filters
 * - Export remixed audio
 * - Prepare for Arweave/IPFS storage
 */
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout
  title="Audio Remix Lab"
  description="Upload, remix, and generate daily sounds for NFT cards"
  activeSection="music"
>

<div class="remix-lab-page scanlines">
  <div class="container mx-auto">

    <!-- Header -->
    <header class="lab-header pixel-border arcade-screen">
      <div class="header-badge">
        <span class="neon-text blink">‚ö° REMIX LABORATORY ‚ö°</span>
      </div>
      <h1 class="lab-title glitch">
        <span class="block">AUDIO REMIX</span>
        <span class="block neon-text">WORKSHOP</span>
      </h1>
      <p class="lab-subtitle mono">
        > UPLOAD_MEDIA()<br/>
        > GENERATE_VECTORS()<br/>
        > MIX_AND_REMIX()<br/>
        <span class="text-cyan blink">‚ñà</span>
      </p>
    </header>

    <!-- Main Lab Interface -->
    <div class="lab-workspace">

      <!-- Left Panel: Upload -->
      <section class="lab-panel upload-panel card-retro">
        <h2 class="panel-title mono neon-text">[ UPLOAD ]</h2>

        <!-- Audio Upload -->
        <div class="upload-section">
          <h3 class="section-label mono">AUDIO FILES:</h3>
          <div class="upload-zone" id="audioUploadZone">
            <div class="upload-icon">üéµ</div>
            <div class="upload-text mono">
              DRAG & DROP AUDIO<br/>
              or CLICK TO BROWSE
            </div>
            <div class="upload-formats mono text-cyan">
              WAV ‚Ä¢ MP3 ‚Ä¢ M4A ‚Ä¢ OGG
            </div>
            <input type="file" id="audioFileInput" accept=".wav,.mp3,.m4a,.ogg,audio/*" multiple style="display: none;">
          </div>

          <!-- Uploaded Audio List -->
          <div id="audioFileList" class="file-list">
            <!-- Files will be added here dynamically -->
          </div>
        </div>

        <!-- Image Upload (for vector conversion) -->
        <div class="upload-section">
          <h3 class="section-label mono">IMAGE FILES:</h3>
          <div class="upload-zone" id="imageUploadZone">
            <div class="upload-icon">üñºÔ∏è</div>
            <div class="upload-text mono">
              DRAG & DROP IMAGE<br/>
              for VECTOR CONVERSION
            </div>
            <div class="upload-formats mono text-cyan">
              PNG ‚Ä¢ JPG ‚Ä¢ BMP ‚Ä¢ SVG
            </div>
            <input type="file" id="imageFileInput" accept=".png,.jpg,.jpeg,.bmp,.svg,image/*" multiple style="display: none;">
          </div>

          <!-- Uploaded Image List -->
          <div id="imageFileList" class="file-list">
            <!-- Files will be added here dynamically -->
          </div>
        </div>
      </section>

      <!-- Center Panel: Remix Controls -->
      <section class="lab-panel remix-panel card-retro-neon">
        <h2 class="panel-title mono neon-text">[ REMIX ENGINE ]</h2>

        <!-- Source Selection -->
        <div class="control-group">
          <label class="control-label mono">AUDIO SOURCE 1:</label>
          <select id="source1Select" class="control-select mono">
            <option value="">-- Select Audio --</option>
            <option value="generated">Generated Sound</option>
          </select>
          <button id="play1Btn" class="btn-control btn-retro-neon mono" disabled>‚ñ∂ PLAY</button>
        </div>

        <div class="control-group">
          <label class="control-label mono">AUDIO SOURCE 2:</label>
          <select id="source2Select" class="control-select mono">
            <option value="">-- Select Audio --</option>
            <option value="generated">Generated Sound</option>
          </select>
          <button id="play2Btn" class="btn-control btn-retro-neon mono" disabled>‚ñ∂ PLAY</button>
        </div>

        <!-- Mix Controls -->
        <div class="control-group">
          <label class="control-label mono">MIX BALANCE:</label>
          <input type="range" id="mixBalance" min="0" max="100" value="50" class="control-slider">
          <div class="slider-labels mono">
            <span>SOURCE 1</span>
            <span id="mixBalanceValue">50/50</span>
            <span>SOURCE 2</span>
          </div>
        </div>

        <!-- Effects -->
        <div class="effects-section">
          <h3 class="section-label mono text-neon">EFFECTS:</h3>

          <div class="effect-row">
            <label class="effect-label mono">REVERB:</label>
            <input type="range" id="reverbAmount" min="0" max="100" value="0" class="effect-slider">
            <span class="effect-value mono" id="reverbValue">0%</span>
          </div>

          <div class="effect-row">
            <label class="effect-label mono">DELAY:</label>
            <input type="range" id="delayAmount" min="0" max="100" value="0" class="effect-slider">
            <span class="effect-value mono" id="delayValue">0%</span>
          </div>

          <div class="effect-row">
            <label class="effect-label mono">DISTORTION:</label>
            <input type="range" id="distortionAmount" min="0" max="100" value="0" class="effect-slider">
            <span class="effect-value mono" id="distortionValue">0%</span>
          </div>

          <div class="effect-row">
            <label class="effect-label mono">PITCH SHIFT:</label>
            <input type="range" id="pitchShift" min="-12" max="12" value="0" class="effect-slider">
            <span class="effect-value mono" id="pitchValue">0</span>
          </div>
        </div>

        <!-- Generate Button -->
        <button id="generateRemixBtn" class="btn-generate btn-retro" disabled>
          <span class="btn-icon">üéõÔ∏è</span>
          <span class="btn-text">GENERATE REMIX</span>
        </button>
      </section>

      <!-- Right Panel: Output & Export -->
      <section class="lab-panel output-panel card-retro">
        <h2 class="panel-title mono neon-text">[ OUTPUT ]</h2>

        <!-- Waveform Display -->
        <div class="waveform-display">
          <canvas id="waveformCanvas" width="400" height="200"></canvas>
          <div class="waveform-placeholder mono" id="waveformPlaceholder">
            WAVEFORM PREVIEW<br/>
            <span class="text-cyan">GENERATE REMIX TO SEE</span>
          </div>
        </div>

        <!-- Playback Controls -->
        <div class="playback-controls">
          <button id="playRemixBtn" class="btn-playback btn-retro-neon mono" disabled>
            ‚ñ∂ PLAY REMIX
          </button>
          <button id="stopRemixBtn" class="btn-playback btn-retro mono" disabled>
            ‚ñ† STOP
          </button>
        </div>

        <!-- Export Options -->
        <div class="export-section">
          <h3 class="section-label mono text-neon">EXPORT TO:</h3>

          <div class="export-grid">
            <button class="export-btn btn-retro mono" id="exportLocalBtn" disabled>
              üíæ DOWNLOAD<br/>
              <span class="btn-sublabel">Save to Device</span>
            </button>

            <button class="export-btn btn-retro-neon mono" id="exportIPFSBtn" disabled>
              üåê IPFS/PINATA<br/>
              <span class="btn-sublabel">Decentralized</span>
            </button>

            <button class="export-btn btn-retro mono" id="exportArweaveBtn" disabled>
              ‚ôæÔ∏è ARWEAVE<br/>
              <span class="btn-sublabel">Permanent</span>
            </button>

            <button class="export-btn btn-retro mono" id="exportCloudflareBtn" disabled>
              ‚òÅÔ∏è CLOUDFLARE<br/>
              <span class="btn-sublabel">Edge CDN</span>
            </button>
          </div>

          <!-- Storage Info -->
          <div id="storageInfo" class="storage-info mono" style="display: none;">
            <div class="info-line">
              <span class="info-label">File Size:</span>
              <span class="info-value" id="fileSize">--</span>
            </div>
            <div class="info-line">
              <span class="info-label">Est. Cost:</span>
              <span class="info-value" id="estCost">--</span>
            </div>
            <div class="info-line">
              <span class="info-label">Status:</span>
              <span class="info-value text-neon" id="uploadStatus">Ready</span>
            </div>
          </div>
        </div>
      </section>

    </div>

    <!-- Vector Conversion Panel -->
    <section class="vector-panel card-retro ska-pattern">
      <h2 class="panel-title mono neon-text">[ IMAGE ‚Üí AUDIO VECTOR CONVERSION ]</h2>
      <p class="panel-description mono">
        Convert uploaded images to audio parameters. Pixel brightness, color channels, and edge detection
        influence frequency, amplitude, and filter settings.
      </p>

      <div class="conversion-controls">
        <div class="control-row">
          <label class="control-label mono">CONVERSION MODE:</label>
          <select id="conversionMode" class="control-select mono">
            <option value="brightness">Brightness ‚Üí Frequency</option>
            <option value="rgb">RGB Channels ‚Üí 3 Oscillators</option>
            <option value="edge">Edge Detection ‚Üí Percussion</option>
            <option value="gradient">Color Gradient ‚Üí Filter Sweep</option>
          </select>
        </div>

        <div class="control-row">
          <label class="control-label mono">SCAN DIRECTION:</label>
          <select id="scanDirection" class="control-select mono">
            <option value="horizontal">Horizontal (Left‚ÜíRight)</option>
            <option value="vertical">Vertical (Top‚ÜíBottom)</option>
            <option value="spiral">Spiral (Center‚ÜíOut)</option>
            <option value="random">Random Pixels</option>
          </select>
        </div>

        <button id="convertImageBtn" class="btn-convert btn-retro" disabled>
          <span class="btn-icon">üé®‚Üíüéµ</span>
          <span class="btn-text">CONVERT IMAGE TO SOUND</span>
        </button>
      </div>

      <!-- Conversion Preview -->
      <div id="conversionPreview" class="conversion-preview" style="display: none;">
        <canvas id="imagePreviewCanvas" width="200" height="200"></canvas>
        <div class="conversion-stats mono">
          <div>Pixels Analyzed: <span id="pixelCount">0</span></div>
          <div>Frequencies Generated: <span id="freqCount">0</span></div>
          <div>Duration: <span id="audioDuration">0.0</span>s</div>
        </div>
      </div>
    </section>

    <!-- Instructions -->
    <section class="instructions-panel card-retro-neon">
      <h2 class="panel-title mono neon-text">[ QUICK START ]</h2>
      <ol class="instructions-list mono">
        <li>Upload audio files or images using drag & drop</li>
        <li>Select two audio sources (uploaded or generated)</li>
        <li>Adjust mix balance and apply effects</li>
        <li>Generate the remix and preview waveform</li>
        <li>Export to local device or decentralized storage</li>
      </ol>

      <div class="tips-box ska-pattern">
        <h3 class="tips-title mono">üí° PRO TIPS:</h3>
        <ul class="tips-list mono">
          <li>Image conversion works best with high-contrast images</li>
          <li>Combine generated sounds with uploaded beats for unique results</li>
          <li>Arweave export provides permanent, immutable storage</li>
          <li>IPFS allows for content-addressed retrieval via CID</li>
          <li>Exported audio is ready for NFT minting!</li>
        </ul>
      </div>
    </section>

    <!-- Navigation -->
    <nav class="lab-nav">
      <a href="/nft-gallery" class="btn-retro">‚Üê NFT GALLERY</a>
      <a href="/music" class="btn-retro-neon">MUSIC STUDIO</a>
      <a href="/" class="btn-retro">HOME ‚Üí</a>
    </nav>

  </div>
</div>

<script src="/scripts/enhanced-sound-generator.js"></script>
<script>
  /**
   * Audio Remix Lab Interactive Functionality
   */

  let uploadedAudioFiles = [];
  let uploadedImageFiles = [];
  let soundGenerator = null;
  let remixAudioBuffer = null;

  // Initialize sound generator
  soundGenerator = new EnhancedSoundGenerator();

  // File upload handlers
  function setupFileUpload(zoneId, inputId, fileList, fileArray, fileType) {
    const zone = document.getElementById(zoneId);
    const input = document.getElementById(inputId);
    const list = document.getElementById(fileList);

    if (!zone || !input) return;

    zone.addEventListener('click', () => input.click());

    zone.addEventListener('dragover', (e) => {
      e.preventDefault();
      zone.classList.add('drag-over');
    });

    zone.addEventListener('dragleave', () => {
      zone.classList.remove('drag-over');
    });

    zone.addEventListener('drop', (e) => {
      e.preventDefault();
      zone.classList.remove('drag-over');
      handleFiles(e.dataTransfer.files, fileArray, list, fileType);
    });

    input.addEventListener('change', (e) => {
      handleFiles(e.target.files, fileArray, list, fileType);
    });
  }

  function handleFiles(files, fileArray, listEl, fileType) {
    Array.from(files).forEach(file => {
      if (file.size > 10_000_000) { // 10MB limit
        alert(`File ${file.name} is too large (max 10MB)`);
        return;
      }

      const fileObj = {
        name: file.name,
        size: file.size,
        type: file.type,
        file: file,
        url: URL.createObjectURL(file)
      };

      fileArray.push(fileObj);
      addFileToList(fileObj, listEl, fileArray, fileType);

      // Add to source selects if audio
      if (fileType === 'audio') {
        addToSourceSelect(fileObj);
      }
    });

    updateControlStates();
  }

  function addFileToList(fileObj, listEl, fileArray, fileType) {
    const item = document.createElement('div');
    item.className = 'file-item mono';
    item.innerHTML = `
      <div class="file-icon">${fileType === 'audio' ? 'üéµ' : 'üñºÔ∏è'}</div>
      <div class="file-info">
        <div class="file-name">${fileObj.name}</div>
        <div class="file-size">${(fileObj.size / 1024).toFixed(1)} KB</div>
      </div>
      <button class="file-remove" data-name="${fileObj.name}">‚úï</button>
    `;

    item.querySelector('.file-remove').addEventListener('click', () => {
      const index = fileArray.findIndex(f => f.name === fileObj.name);
      if (index > -1) {
        fileArray.splice(index, 1);
        item.remove();
        if (fileType === 'audio') {
          removeFromSourceSelect(fileObj.name);
        }
        updateControlStates();
      }
    });

    listEl.appendChild(item);
  }

  function addToSourceSelect(fileObj) {
    const option1 = document.createElement('option');
    option1.value = fileObj.name;
    option1.textContent = fileObj.name;
    document.getElementById('source1Select').appendChild(option1);

    const option2 = document.createElement('option');
    option2.value = fileObj.name;
    option2.textContent = fileObj.name;
    document.getElementById('source2Select').appendChild(option2);
  }

  function removeFromSourceSelect(fileName) {
    const sel1 = document.getElementById('source1Select');
    const sel2 = document.getElementById('source2Select');

    Array.from(sel1.options).forEach(opt => {
      if (opt.value === fileName) opt.remove();
    });
    Array.from(sel2.options).forEach(opt => {
      if (opt.value === fileName) opt.remove();
    });
  }

  function updateControlStates() {
    const source1 = document.getElementById('source1Select').value;
    const source2 = document.getElementById('source2Select').value;
    const hasImages = uploadedImageFiles.length > 0;

    document.getElementById('generateRemixBtn').disabled = !source1 || !source2;
    document.getElementById('convertImageBtn').disabled = !hasImages;
    document.getElementById('play1Btn').disabled = !source1;
    document.getElementById('play2Btn').disabled = !source2;
  }

  // Effect sliders
  function setupEffectSliders() {
    const sliders = [
      { id: 'mixBalance', valueId: 'mixBalanceValue', format: v => `${100-v}/${v}` },
      { id: 'reverbAmount', valueId: 'reverbValue', format: v => `${v}%` },
      { id: 'delayAmount', valueId: 'delayValue', format: v => `${v}%` },
      { id: 'distortionAmount', valueId: 'distortionValue', format: v => `${v}%` },
      { id: 'pitchShift', valueId: 'pitchValue', format: v => v }
    ];

    sliders.forEach(({ id, valueId, format }) => {
      const slider = document.getElementById(id);
      const valueEl = document.getElementById(valueId);

      if (slider && valueEl) {
        slider.addEventListener('input', (e) => {
          valueEl.textContent = format(e.target.value);
        });
      }
    });
  }

  // Generate remix
  document.getElementById('generateRemixBtn')?.addEventListener('click', () => {
    alert('Remix generation feature coming soon! This will mix selected audio sources with applied effects.');

    // Enable export buttons (mock)
    document.querySelectorAll('.export-btn').forEach(btn => btn.disabled = false);
    document.getElementById('playRemixBtn').disabled = false;
    document.getElementById('stopRemixBtn').disabled = false;
    document.getElementById('storageInfo').style.display = 'block';
    document.getElementById('fileSize').textContent = '2.4 MB';
    document.getElementById('estCost').textContent = '$0.02 (Arweave)';
  });

  // Convert image to sound
  document.getElementById('convertImageBtn')?.addEventListener('click', () => {
    alert('Image-to-audio conversion coming soon! This will analyze pixel data and generate sound waves.');
    document.getElementById('conversionPreview').style.display = 'flex';
  });

  // Export handlers
  document.getElementById('exportLocalBtn')?.addEventListener('click', () => {
    alert('Downloading remix... (feature in progress)');
  });

  document.getElementById('exportIPFSBtn')?.addEventListener('click', () => {
    alert('Uploading to IPFS via Pinata... (feature in progress)');
  });

  document.getElementById('exportArweaveBtn')?.addEventListener('click', () => {
    alert('Uploading to Arweave... (feature in progress)');
  });

  document.getElementById('exportCloudflareBtn')?.addEventListener('click', () => {
    alert('Uploading to Cloudflare R2... (feature in progress)');
  });

  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    setupFileUpload('audioUploadZone', 'audioFileInput', 'audioFileList', uploadedAudioFiles, 'audio');
    setupFileUpload('imageUploadZone', 'imageFileInput', 'imageFileList', uploadedImageFiles, 'image');
    setupEffectSliders();
    updateControlStates();

    document.getElementById('source1Select')?.addEventListener('change', updateControlStates);
    document.getElementById('source2Select')?.addEventListener('change', updateControlStates);
  });
</script>

<style>
  .remix-lab-page {
    min-height: 100vh;
    background: var(--color-black);
    padding: 3rem 2rem;
  }

  /* Header */
  .lab-header {
    text-align: center;
    padding: 3rem 2rem;
    margin-bottom: 3rem;
    background: var(--color-near-black);
  }

  .header-badge {
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
    font-family: var(--font-mono);
  }

  .lab-title {
    font-size: 3.5rem;
    font-weight: 900;
    margin-bottom: 1.5rem;
    font-family: var(--font-mono);
    letter-spacing: 4px;
    line-height: 1.1;
  }

  .lab-subtitle {
    font-size: 1.25rem;
    line-height: 2;
  }

  /* Workspace */
  .lab-workspace {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
    margin-bottom: 3rem;
  }

  .lab-panel {
    padding: 2rem;
    min-height: 600px;
    display: flex;
    flex-direction: column;
  }

  .panel-title {
    font-size: 1.25rem;
    font-weight: 900;
    margin-bottom: 2rem;
    text-align: center;
    letter-spacing: 2px;
  }

  /* Upload Zone */
  .upload-section {
    margin-bottom: 2rem;
  }

  .section-label {
    font-size: 0.875rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    color: var(--color-white);
    letter-spacing: 1px;
  }

  .upload-zone {
    border: 3px dashed var(--color-white);
    padding: 2rem 1rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: var(--color-near-black);
  }

  .upload-zone:hover,
  .upload-zone.drag-over {
    border-color: var(--color-neon-green);
    background: rgba(0, 255, 0, 0.05);
    box-shadow: 0 0 20px var(--color-neon-green-glow);
  }

  .upload-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .upload-text {
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 0.75rem;
  }

  .upload-formats {
    font-size: 0.75rem;
  }

  /* File List */
  .file-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 1rem;
  }

  .file-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--color-dark-gray);
    border: 2px solid var(--color-white);
    margin-bottom: 0.5rem;
  }

  .file-icon {
    font-size: 1.5rem;
  }

  .file-info {
    flex: 1;
  }

  .file-name {
    font-size: 0.875rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
  }

  .file-size {
    font-size: 0.75rem;
    color: var(--color-light-gray);
  }

  .file-remove {
    background: var(--color-black);
    color: var(--color-white);
    border: 2px solid var(--color-white);
    padding: 0.25rem 0.5rem;
    cursor: pointer;
    font-weight: 900;
  }

  .file-remove:hover {
    background: #dc2626;
  }

  /* Controls */
  .control-group {
    margin-bottom: 1.5rem;
  }

  .control-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }

  .control-select {
    width: 100%;
    padding: 0.75rem;
    background: var(--color-black);
    color: var(--color-white);
    border: 2px solid var(--color-white);
    font-family: var(--font-mono);
    margin-bottom: 0.5rem;
  }

  .btn-control {
    width: 100%;
    padding: 0.5rem;
  }

  .control-slider {
    width: 100%;
    margin-bottom: 0.5rem;
  }

  .slider-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.75rem;
    color: var(--color-light-gray);
  }

  /* Effects */
  .effects-section {
    margin-top: 2rem;
  }

  .effect-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .effect-label {
    flex: 0 0 100px;
    font-size: 0.75rem;
  }

  .effect-slider {
    flex: 1;
  }

  .effect-value {
    flex: 0 0 50px;
    text-align: right;
    font-size: 0.875rem;
    color: var(--color-neon-green);
  }

  /* Buttons */
  .btn-generate {
    width: 100%;
    padding: 1.25rem;
    margin-top: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    font-size: 1.125rem;
  }

  /* Waveform */
  .waveform-display {
    position: relative;
    width: 100%;
    height: 200px;
    background: var(--color-black);
    border: 2px solid var(--color-white);
    margin-bottom: 1rem;
  }

  .waveform-placeholder {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-size: 0.875rem;
    line-height: 1.8;
  }

  #waveformCanvas {
    width: 100%;
    height: 100%;
  }

  /* Playback */
  .playback-controls {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .btn-playback {
    flex: 1;
    padding: 1rem;
  }

  /* Export */
  .export-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .export-btn {
    padding: 1.5rem 1rem;
    text-align: center;
    line-height: 1.6;
  }

  .btn-sublabel {
    font-size: 0.75rem;
    opacity: 0.8;
  }

  .storage-info {
    background: var(--color-black);
    padding: 1rem;
    border: 2px solid var(--color-neon-green);
    font-size: 0.875rem;
  }

  .info-line {
    display: flex;
    justify-content: space-between;
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--color-dark-gray);
  }

  .info-line:last-child {
    border-bottom: none;
  }

  /* Vector Panel */
  .vector-panel {
    padding: 2rem;
    margin-bottom: 3rem;
  }

  .panel-description {
    font-size: 0.95rem;
    line-height: 1.7;
    margin-bottom: 2rem;
    color: var(--color-off-white);
  }

  .conversion-controls {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
    align-items: end;
  }

  .control-row {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .btn-convert {
    grid-column: 1 / -1;
    padding: 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    font-size: 1.125rem;
  }

  .conversion-preview {
    display: flex;
    gap: 2rem;
    margin-top: 2rem;
    padding: 1.5rem;
    background: var(--color-black);
    border: 2px solid var(--color-white);
  }

  .conversion-stats {
    flex: 1;
    font-size: 0.95rem;
    line-height: 2;
  }

  /* Instructions */
  .instructions-panel {
    padding: 2rem;
    margin-bottom: 3rem;
  }

  .instructions-list {
    font-size: 0.95rem;
    line-height: 2;
    margin-bottom: 2rem;
    padding-left: 2rem;
  }

  .instructions-list li {
    margin-bottom: 0.5rem;
  }

  .tips-box {
    padding: 1.5rem;
  }

  .tips-title {
    font-size: 1.125rem;
    font-weight: 900;
    margin-bottom: 1rem;
    color: var(--color-neon-green);
  }

  .tips-list {
    list-style: none;
    padding: 0;
    font-size: 0.875rem;
    line-height: 2;
  }

  .tips-list li::before {
    content: '‚Üí ';
    color: var(--color-neon-green);
    font-weight: 900;
  }

  /* Navigation */
  .lab-nav {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  /* Mobile */
  @media (max-width: 1024px) {
    .lab-workspace {
      grid-template-columns: 1fr;
    }

    .conversion-controls {
      grid-template-columns: 1fr;
    }

    .btn-convert {
      grid-column: 1;
    }
  }

  @media (max-width: 768px) {
    .lab-title {
      font-size: 2rem;
    }

    .export-grid {
      grid-template-columns: 1fr;
    }

    .lab-nav {
      flex-direction: column;
    }

    .lab-nav a {
      width: 100%;
      text-align: center;
    }
  }
</style>

</BaseLayout>
