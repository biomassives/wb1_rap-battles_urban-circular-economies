---
// You can fetch these from your Postgres/Elixir API later
const artistProfile = {
    handle: "Flow_Guardian_01",
    xp: 750, // This drives the horizontal celestial marks
    tokens: 12,
    id: "BIO-AMZ-772"
};
---

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Artist Identity | PFP Manager</title>
    <style>
        .pfp-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            height: 100vh;
            background: #050505;
            color: #fff;
        }
        #pfp-viewer { background: radial-gradient(circle, #111 0%, #000 100%); }
        .controls { 
            padding: 2rem; 
            border-left: 1px solid #222; 
            display: flex; 
            flex-direction: column; 
            gap: 1.5rem;
        }
        .stat-card { background: #111; padding: 1rem; border-radius: 4px; border: 1px solid #333; }
        .glow-text { color: #aae8ff; text-shadow: 0 0 10px #aae8ff55; }
    </style>
</head>
<body>
    <main class="pfp-grid">
        <div id="pfp-viewer"></div>

        <aside class="controls">
            <div>
                <h1 class="glow-text">@{artistProfile.handle}</h1>
                <code>ID: {artistProfile.id}</code>
            </div>

            <div class="stat-card">
                <label>BIODIVERSITY XP</label>
                <div class="value" id="xp-display">{artistProfile.xp}</div>
                <div style="width: 100%; height: 4px; background: #222; margin-top: 8px;">
                    <div style={`width: ${(artistProfile.xp/2000)*100}%; height: 100%; background: #aae8ff;`}></div>
                </div>
            </div>

            <button id="update-identity" class="btn-action">SYNC ON-CHAIN DATA</button>
            <button id="battle-ready" class="btn-action">ENTER BATTLE CIRCLE</button>
        </aside>
    </main>

    <script>
        import { initBling } from '../components/BlingCanvas.js';

        // Load current state
        const artistData = {
            identity_path: "M250 140 V190 M230 160 H270", // Example path
            glow_intensity: 0.75,
            xp: 750
        };

        const container = document.getElementById('pfp-viewer');
        
        // Initialize your layered SVG in 3D
        initBling(container, artistData);

        // Interaction for your PFP Manager
        document.getElementById('update-identity').addEventListener('click', () => {
            console.log("Fetching latest biodiversity tokens...");
            // Trigger your triggerStarlightRedemption function here
        });
    </script>
</body>
</html>
