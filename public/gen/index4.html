<!DOCTYPE html>
<html>
<head>
    <title>Worldbridger Glitch Lab</title>
    <style>
        body { background: #1a1a1c; color: #eee; font-family: 'Courier New', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .ui-layer { background: rgba(30,30,35,0.95); padding: 12px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; border-bottom: 2px solid #444; z-index: 100; font-size: 10px; text-transform: uppercase; }
        .group { border-left: 1px solid #555; padding: 0 10px; display: flex; flex-direction: column; }
        input { width: 100%; accent-color: #ff4500; }
        svg { flex-grow: 1; width: 100%; background: #2c2c34; }
    </style>
</head>
<body>

<div class="ui-layer">
    <div class="group">
        <label>Image Stack Drift</label>
        <input type="range" id="drift" min="0" max="50" value="10">
        <label>Shield Shape (Warp)</label>
        <input type="range" id="shieldWarp" min="0" max="150" value="0">
    </div>
    <div class="group">
        <label>BG Text Clarity</label>
        <input type="range" id="bgClarity" min="0" max="1" step="0.1" value="0.3">
        <label>Subtext Brightness</label>
        <input type="range" id="textBright" min="0.2" max="1" step="0.1" value="0.8">
    </div>
    <div class="group">
        <label>Form Population</label>
        <input type="range" id="popCount" min="1" max="15" value="1">
        <label>Grit Intensity</label>
        <input type="range" id="grit" min="0.01" max="0.2" step="0.01" value="0.04">
    </div>
    <div class="group">
        <label>Line 1</label><input type="text" id="sub1" value="ECOCITY/EXOTOPIA">
        <label>Line 2</label><input type="text" id="sub2" value="NFT REWARDS">
    </div>
</div>

<svg id="viz" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <pattern id="pathlineText" width="400" height="40" patternUnits="userSpaceOnUse" patternTransform="rotate(-5)">
            <text x="0" y="30" fill="#4a4a55" font-size="12" font-weight="bold" opacity="0.5">
                WORLDBRIDGER_SYSTEM_DATA_FLOW_0xBDV_TRANSPARENCY_INIT_
            </text>
        </pattern>

        <filter id="glitchFilter">
            <feTurbulence id="glitchTurb" type="fractalNoise" baseFrequency="0.04" numOctaves="2" result="noise" />
            <feDisplacementMap in="SourceGraphic" in2="noise" scale="10" xChannelSelector="R" yChannelSelector="G" />
        </filter>

        <filter id="gritFilter">
            <feTurbulence id="gritTurb" type="fractalNoise" baseFrequency="0.1" numOctaves="4" />
            <feColorMatrix type="saturate" values="0" />
        </filter>
        
        <pattern id="shieldHatch" width="4" height="4" patternUnits="userSpaceOnUse">
            <rect width="4" height="4" fill="#080808" />
            <path d="M0,4 l4,-4" stroke="#222" stroke-width="0.5" />
        </pattern>
    </defs>

    <rect width="1000" height="1000" fill="#2c2c34" />
    <rect id="bgTextLayer" width="1000" height="1000" fill="url(#pathlineText)" />
    <rect width="1000" height="1000" filter="url(#gritFilter)" opacity="0.2" style="mix-blend-mode: overlay;" />

    <g id="organismContainer" filter="url(#glitchFilter)"></g>

    <path id="mainShield" d="M50,280 L950,280 L880,480 L500,820 L120,480 Z" fill="url(#shieldHatch)" filter="url(#glitchFilter)" />

    <g id="imageStack">
        <image id="layer1" href="wblayer1.png" x="150" y="250" width="700" height="400" opacity="0.9" style="mix-blend-mode: screen;"/>
        <image id="layer2" href="wblayer2.png" x="150" y="250" width="700" height="400" opacity="0.7" style="mix-blend-mode: plus-lighter;"/>
        <image id="layer3" href="wblayer3.png" x="150" y="250" width="700" height="400" opacity="0.5" style="mix-blend-mode: overlay;"/>
    </g>

    <g text-anchor="middle" font-weight="900">
        <text id="st1" x="500" y="880" fill="#fff" font-size="28">ECOCITY/EXOTOPIA</text>
        <text id="st2" x="500" y="920" fill="#fff" font-size="28">NFT REWARDS</text>
    </g>
</svg>

<script>
    const state = {
        drift: document.getElementById('drift'),
        shieldWarp: document.getElementById('shieldWarp'),
        bgClarity: document.getElementById('bgClarity'),
        textBright: document.getElementById('textBright'),
        grit: document.getElementById('grit'),
        pop: document.getElementById('popCount')
    };

    const elements = {
        l1: document.getElementById('layer1'),
        l2: document.getElementById('layer2'),
        l3: document.getElementById('layer3'),
        shield: document.getElementById('mainShield'),
        bgText: document.getElementById('bgTextLayer'),
        st1: document.getElementById('st1'),
        st2: document.getElementById('st2'),
        gritTurb: document.getElementById('gritTurb'),
        glitchTurb: document.getElementById('glitchTurb'),
        container: document.getElementById('organismContainer')
    };

    function update() {
        // Text/BG Management
        elements.bgText.setAttribute('opacity', state.bgClarity.value);
        elements.st1.setAttribute('opacity', state.textBright.value);
        elements.st2.setAttribute('opacity', state.textBright.value);
        elements.gritTurb.setAttribute('baseFrequency', state.grit.value);
        
        // Shape Warping (Adjusting the 'Vanishing Point' based on slider)
        const warp = state.shieldWarp.value;
        elements.shield.setAttribute('d', `M50,280 L950,280 L${880 - warp},480 L500,820 L${120 + Number(warp)},480 Z`);
    }

    let tick = 0;
    function animate() {
        tick += 0.05;
        const d = state.drift.value / 10;
        
        // Stack Animation (Brownian/Sine drift)
        elements.l1.setAttribute('transform', `translate(${Math.sin(tick)*d}, ${Math.cos(tick)*d})`);
        elements.l2.setAttribute('transform', `translate(${Math.cos(tick*0.8)*d*1.5}, ${Math.sin(tick*1.2)*d})`);
        elements.l3.setAttribute('transform', `translate(${Math.sin(tick*1.5)*d*2}, ${Math.cos(tick*0.5)*d*2})`);
        
        // Glitch flicker
        if(Math.random() > 0.95) {
            elements.glitchTurb.setAttribute('baseFrequency', Math.random() * 0.1);
        }

        requestAnimationFrame(animate);
    }

    document.querySelectorAll('input').forEach(i => i.addEventListener('input', update));
    update();
    animate();
</script>
</body>
</html>
